)
data <- data %>%
mutate(Site = ifelse(grepl("^A", ID), "With Visible Biota", "Without Visible Biota"))
# ---- helper to make dual-axis plot for one site ----
make_dual_plot <- function(df_site, site_label) {
df <- df_site %>%
filter(!is.na(Distance)) %>%
arrange(Distance)
# ranges for scaling
tmin <- min(df$AvgTemp, na.rm = TRUE)
tmax <- max(df$AvgTemp, na.rm = TRUE)
smin <- min(df$SiO2, na.rm = TRUE)
smax <- max(df$SiO2, na.rm = TRUE)
# if any series is all-NA, handle gracefully
if (!is.finite(tmin) | !is.finite(tmax)) { tmin <- 0; tmax <- 1 }
if (!is.finite(smin) | !is.finite(smax)) { smin <- 0; smax <- 1 }
trng <- tmax - tmin
srng <- smax - smin
if (trng == 0) trng <- 1
if (srng == 0) srng <- 1
# scale silica onto temp axis
df <- df %>%
mutate(SiO2_scaled = (SiO2 - smin) / srng * trng + tmin)
ggplot(df, aes(x = Distance)) +
# Temperature (primary axis)
geom_line(aes(y = AvgTemp, color = "Avg Temp", linetype = "Avg Temp"), linewidth = 1, na.rm = TRUE) +
geom_point(aes(y = AvgTemp, color = "Avg Temp", shape = "Avg Temp"), size = 3, na.rm = TRUE) +
# Silica (scaled to primary axis, with secondary axis shown)
geom_line(aes(y = SiO2_scaled, color = "SiO2", linetype = "SiO2"), linewidth = 1, na.rm = TRUE) +
geom_point(aes(y = SiO2_scaled, color = "SiO2", shape = "SiO2"), size = 3, na.rm = TRUE) +
scale_color_manual(
name = NULL,
values = c("Avg Temp" = "#7570b3", "SiO2" = "#7570b3")
) +
scale_shape_manual(
name = NULL,
values = c("Avg Temp" = 16, "SiO2" = 17)  # dots & triangles
) +
scale_linetype_manual(
name = NULL,
values = c("Avg Temp" = "solid", "SiO2" = "dashed")
) +
scale_y_continuous(
name = "Average Temperature (°C)",
sec.axis = sec_axis(
~ (.-tmin) / trng * srng + smin,
name = expression(paste("SiO"[2], " (ppm)"))
)
) +
labs(
x = "Distance from vent (m)",
title = paste0("Temp. & Silica Conc. vs Distance: Without Visible Biomass", substr(site_label, 1, 1))
) +
theme_minimal(base_size = 10) +
theme(
legend.position = c(0.68, 0.85),
legend.background = element_rect(fill = "white", color = "grey70", linewidth = 0.3),
legend.box.background = element_blank(),
legend.text = element_text(size = 11),
panel.grid.minor = element_blank()
)
}
# ---- split data and plot ----
data_A <- data %>% filter(Site == "With Visible Biota")
data_B <- data %>% filter(Site == "Without Visible Biota")
plot_A <- make_dual_plot(data_A, "With Visible Biota")
plot_B <- make_dual_plot(data_B, "Without Visible Biota")
plot_A
plot_B
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
# Add site labels
data <- data %>%
mutate(Site = ifelse(grepl("^A", ID), "With Visible Biota", "Without Visible Biota"))
library(ggplot2)
library(dplyr)
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "With Visible Biomass", "Without Visible Biomass"))
ggplot(data, aes(x = AvgTemp, y = SiO2, fill = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(values = c("With Visible Biomass" = "#66c2a5",
"Without Visible Biomass" = "#fc8d62")) +
labs(
x = "Average Temperature (°C)",
y = expression(paste("SiO"[2], " [ppm]"))
) +
theme_minimal(base_size = 16) +
theme(
legend.title = element_blank(),
legend.position = "right",
plot.title = element_blank()
)
library(ggplot2)
library(dplyr)
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "With Visible Biomass", "Without Visible Biomass"))
ggplot(data, aes(x = AvgTemp, y = SiO2, fill = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(values = c("With Visible Biomass" = "#66c2a5",
"Without Visible Biomass" = "#fc8d62")) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 16) +
theme(
legend.title = element_blank(),
legend.position = "right",
plot.title = element_blank()
)
library(ggplot2)
library(dplyr)
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "Site With Visible Biomass", "Site Without Visible Biomass"))
ggplot(data, aes(x = AvgTemp, y = SiO2, fill = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.0) +
scale_fill_manual(values = c("Site With Visible Biomass" = "#fc8d62",
"Site Without Visible Biomass" = "#7570b3")) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 16) +
theme(
legend.title = element_blank(),
legend.position = c(0.75, 0.65),  # inside plot (x,y from bottom-left)
legend.background = element_rect(fill = alpha("white", 0.7), color = NA),
plot.title = element_blank()
)
ibrary(ggplot2)
library(dplyr)
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "Site With Visible Biomass", "Site Without Visible Biomass"))
ggplot(data, aes(x = AvgTemp, y = SiO2, fill = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Site Without Visible Biomass" = "#7570b3",
"Site With Visible Biomass" = "#fc8d62"
),
breaks = c("Site Without Visible Biomass",
"Site With Visible Biomass")) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),  # make legend text bigger
legend.position = c(0.65, 0.70),        # inside plot
legend.background = element_rect(fill = alpha("white", 0.7), color = NA),
plot.title = element_blank()
)
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "El Colorido", "Vega Rinconada"))
ggplot(data, aes(x = AvgTemp, y = SiO2, fill = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido" = "#fc8d62"
),
breaks = c("Vega Rinconada",
"El Colorido")) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),  # make legend text bigger
legend.position = c(0.65, 0.70),        # inside plot
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
plot.title = element_blank()
)
# Add Cacao
Cacao <- data.frame(
ID = c("C1","C2","C3","C4"),
AvgTemp = c(84.7907, 74.93525, 53.1253, 45.6243),
SiO2 = c(212.0902576, 212.9322502, 216.1898356, 216.4219391),
Site = "Cacao"
)
data_all <- rbind(
Sitedata %>% mutate(Site = ifelse(grepl("^A", ID), "El Colorido", "Vega Rinconada")),
Cacao
)
ggplot() +
# black lines for original two sites
geom_line(
data = subset(data_all, Site != "Cacao"),
aes(x = AvgTemp, y = SiO2, group = Site),
color = "black",
linewidth = 1.5
) +
# original filled points
geom_point(
data = subset(data_all, Site != "Cacao"),
aes(x = AvgTemp, y = SiO2, fill = Site),
shape = 21, size = 4, color = "black", stroke = 1.5
) +
# Cacao points (green, no line)
geom_point(
data = Cacao,
aes(x = AvgTemp, y = SiO2),
color = "darkgreen", fill = "darkgreen",
shape = 21, size = 4, stroke = 1.5
) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"   = "#fc8d62"
)
) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.position = c(0.65, 0.70)
)
library(dplyr)
library(ggplot2)
# --- Original data ---
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data_main <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "El Colorido", "Vega Rinconada"))
# --- Add Cacao data ---
Cacao <- data.frame(
ID = c("C1","C2","C3","C4"),
AvgTemp = c(84.7907, 74.93525, 53.1253, 45.6243),
SiO2 = c(212.0902576, 212.9322502, 216.1898356, 216.4219391),
Site = "Cacao"
)
# Combine datasets
data_all <- rbind(data_main, Cacao)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),
legend.position = c(0.80, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
# Remove minor gridlines, keep major but fewer from x-scale
panel.grid.minor = element_blank()
)
library(dplyr)
library(ggplot2)
# --- Original data ---
Sitedata <- data.frame(
ID = c("A1","A2","A6","A8","BV","B1","B2","B3"),
AvgTemp = c(69.20559,47.14561,57.76062,18.27668,
63.61698,29.86733,24.87966,19.65037),
SiO2 = c(245.5655676,228.0472778,221.0021403,
249.2798433,322.8145167,322.3265837,320.5659227,
329.9329525)
)
data_main <- Sitedata %>%
mutate(Site = ifelse(grepl("^A", ID), "El Colorido", "Vega Rinconada"))
# --- Add Cacao data ---
Cacao <- data.frame(
ID = c("C1","C2","C3","C4"),
AvgTemp = c(84.7907, 74.93525, 53.1253, 45.6243),
SiO2 = c(212.0902576, 212.9322502, 216.1898356, 216.4219391),
Site = "Cacao"
)
# Combine datasets
data_all <- rbind(data_main, Cacao)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),
legend.position = c(0.80, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
panel.grid.minor = element_blank(),
# >>> CHANGE X-AXIS TITLE FONT SIZE HERE <<<
axis.title.x = element_text(size = 20),
# Optional: make y-axis title match (edit/remove if not wanted)
axis.title.y = element_text(size = 20)
)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),
legend.position = c(0.80, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
panel.grid.minor = element_blank(),
# >>> CHANGE X-AXIS TITLE FONT SIZE HERE <<<
axis.title.x = element_text(size = 20),
# Optional: make y-axis title match (edit/remove if not wanted)
axis.title.y = element_text(size = 20)
)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),
legend.position = c(0.60, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
panel.grid.minor = element_blank(),
# >>> CHANGE X-AXIS TITLE FONT SIZE HERE <<<
axis.title.x = element_text(size = 20),
# Optional: make y-axis title match (edit/remove if not wanted)
axis.title.y = element_text(size = 20)
)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 18),
legend.position = c(0.70, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
panel.grid.minor = element_blank(),
# >>> CHANGE X-AXIS TITLE FONT SIZE HERE <<<
axis.title.x = element_text(size = 20),
# Optional: make y-axis title match (edit/remove if not wanted)
axis.title.y = element_text(size = 20)
)
# --- Final Plot ---
ggplot(data_all, aes(x = AvgTemp, y = SiO2, fill = Site, group = Site)) +
geom_line(color = "black", linewidth = 1.5) +
geom_point(size = 4, shape = 21, color = "black", stroke = 1.5) +
scale_fill_manual(
values = c(
"Vega Rinconada" = "#7570b3",
"El Colorido"    = "#fc8d62",
"Cacao"          = "#1b9e77"
),
breaks = c("Vega Rinconada", "El Colorido", "Cacao")
) +
# ---- FEWER VERTICAL GRIDLINES ----
scale_x_continuous(breaks = seq(20, 80, by = 20)) +
labs(
x = "Average Temperature (°C)",
y = expression("[" * "SiO"[2] * "] (ppm)")
) +
theme_minimal(base_size = 18) +
theme(
legend.title = element_blank(),
legend.text = element_text(size = 20),
legend.position = c(0.70, 0.70),
legend.background = element_rect(fill = alpha("white", 0.8), color = NA),
panel.grid.minor = element_blank(),
# >>> CHANGE X-AXIS TITLE FONT SIZE HERE <<<
axis.title.x = element_text(size = 20),
# Optional: make y-axis title match (edit/remove if not wanted)
axis.title.y = element_text(size = 20)
)
print(pkg_versions)
packages <- c('tidyverse', 'rmarkdown')
pkgs_installed <- sapply(packages,
requireNamespace, quietly = TRUE)
if (!all(pkgs_installed)) {
install.packages(packages)
}
library(dplyr, quietly = TRUE)
pkg_versions <- installed.packages() %>%
dplyr::as_tibble() %>%
filter(Package %in% packages) %>%
select(Package, Version)
print(getwd())
print(R.Version()$version.string)
print(pkg_versions)
setwd("~/Desktop/ontario-report")
